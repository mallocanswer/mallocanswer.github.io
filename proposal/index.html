<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="New Project Webpage
Proposal
Gregor
Gregor Samsa wakes in his bed and discovers he has transformed into a giant BUG.
Zhan Chen (zhanc1) and Lehao Sun (lehaos)
Summary
We are going to implement a paral">
<meta property="og:type" content="website">
<meta property="og:title" content="MallocAnswer's BLOG">
<meta property="og:url" content="http://mallocanswer.github.io/proposal/index.html">
<meta property="og:site_name" content="MallocAnswer's BLOG">
<meta property="og:description" content="New Project Webpage
Proposal
Gregor
Gregor Samsa wakes in his bed and discovers he has transformed into a giant BUG.
Zhan Chen (zhanc1) and Lehao Sun (lehaos)
Summary
We are going to implement a paral">
<meta property="og:updated_time" content="2016-05-07T17:12:57.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MallocAnswer's BLOG">
<meta name="twitter:description" content="New Project Webpage
Proposal
Gregor
Gregor Samsa wakes in his bed and discovers he has transformed into a giant BUG.
Zhan Chen (zhanc1) and Lehao Sun (lehaos)
Summary
We are going to implement a paral">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title>
  

  
     | MallocAnswer's BLOG
  
</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">MallocAnswer's BLOG</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-proposal">
          <a href="/proposal" rel="section">
            
              <i class="menu-item-icon fa fa-columns fa-fw"></i> <br />
            
            Proposal
          </a>
        </li>
      
        
        <li class="menu-item menu-item-checkpoint">
          <a href="/checkpoint" rel="section">
            
              <i class="menu-item-icon fa fa-file fa-fw"></i> <br />
            
            Checkpoint
          </a>
        </li>
      
        
        <li class="menu-item menu-item-report">
          <a href="/report" rel="section">
            
              <i class="menu-item-icon fa fa-file-text fa-fw"></i> <br />
            
            Report
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
      <p><a href="http://mallocanswer.github.io/2016/04/19/Gregor/">New Project Webpage</a></p>
<h1>Proposal</h1>
<h1>Gregor</h1>
<h5><em>Gregor Samsa wakes in his bed and discovers he has transformed into a giant BUG.</em></h5>
<p><a href="https://github.com/Zhancc" target="_blank" rel="external">Zhan Chen</a> (zhanc1) and <a href="https://github.com/mallocanswer" target="_blank" rel="external">Lehao Sun</a> (lehaos)</p>
<h2>Summary</h2>
<p>We are going to implement a parallel programming framework library for C (or C++). It would mimic the semantics of <code>spawn</code> and <code>sync</code> in Cilk, where the programmer simply identifies the independent parallel tasks and library would take care of the scheduling and work stealing.</p>
<h2>Background</h2>
<p>Cilk proposed an interesting parallel programming model which hide the thread execution policies from the programmers so that the programmer simply identified the parallelism and runtime will take care of implementation mappings<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>. Its most prominent feature, work stealing scheduler<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>, was proved to enjoy some nice spatial and time properties. While it extended the syntax of C, we tend to add these features as a C(++) library. As a result, however, the programmers have to follow certain disciplines. We try to provide those syntactic and semantics sugars, like work stealing sheduling and performance guarantees in our library and make things as easy as possible.</p>
<h2>Challenge</h2>
<p><strong>Continuation</strong><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>: In order to distribute the jobs among workers, we have to abstract them in a managable way and be able to handle them under stack disciplines.</p>
<p><strong>Thread Tree</strong><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>: As in Cilk, each threaded procedure is implicitly synced just before return, which means we need to maintain a global thread “tree” data structure that potentially can be accessed by all the workers simultaneously, where each node represents a thread and each edge corresponds either a <code>spawn</code> site or a <code>sync</code> site. The manipulation of the tree must be scalable to achieve good performance.</p>
<p><strong>Thread Scheduling and Work Stealing</strong>: With multiple continuations in hands, which threads should be picked to work on them and how should stealing be implemented in a way that can scale across many cores. Perhaps with the extra information about the characteristic of the job, we hope to come up with a more reasonable/workload aware sheduling.</p>
<h2>Resources</h2>
<p>We will start the project from scratch. The implementation will be tested on multi-core computers in different scale (personal computer, ghc cluster, latedays and hopefully an equipment with more cores).</p>
<h2>Goals and deliverables</h2>
<h4>Basic goals</h4>
<p>Our goal is to implement a parallel programming framework which supports <code>spawn</code> and <code>sync</code> semantics and work-stealing scheduler. The first implementation will use pthread library on Linux.</p>
<p>To be specific, the <code>spawn</code> should create a new task to schedule, who can take arguments and whose return value can be stored to a designated location asynchrously and be used later, just like an assignment in Cilk with <code>spawn</code> on the right hand side and a variable on the left hand side. The worker pool based architecture would enforce workload distribution by work stealing scheduling<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>.</p>
<p><code>sync</code> will not resume until all the descendant tasks are completed. Before return from a spawned function, there will be an implicit <code>sync</code> just as in Cilk.</p>
<p>We will test our implement on different applications on computers with different number of cores.</p>
<h4>More we hope to achieve</h4>
<p>If we have time, we will get rid of pthead library and implement our own version of thread abstraction. We try to implement more lightweight solution.</p>
<p>If everything goes well, we will introduce more advanced features into our thread library, such as <code>inlet</code> and <code>abort</code>.</p>
<h2>Benchmarks</h2>
<p>We will evaluate our framework by rewriting several applications originally in Cilk. Those applications are carefully selected from Cilk paper benchmarks in order to test the performance under different scenarios with the state-of-art implementation.<br>
The applications are described below (the orginal implementation is from <sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>):</p>
<ul>
<li><code>fib(n)</code> Calculate the nth Fibonacci number</li>
<li><code>heat(n)</code> Heat-diffusion calculation on an m􏰾 x n mesh</li>
<li><code>knapsack(n)</code> Solve the 0-1 knapsack problem on n items</li>
<li><code>lu(n)</code> LU-decomposition (without pivoting) of a dense n x n matrix</li>
<li><code>magic(n)</code> Computes the number of n x n magic squares</li>
<li><code>matmul(n)</code> Rectangular matrix multiplication</li>
<li><code>plu(n)</code> Parallel LU Decomposition with Partial Pivoting</li>
</ul>
<h2>Schedule</h2>
<table>
<thead>
<tr>
<th style="text-align:center">Time</th>
<th style="text-align:left">Plan</th>
<th style="text-align:center">Check</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">April 1-April 3</td>
<td style="text-align:left">Literature review on work stealing and Cilk</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">April 4-April 10</td>
<td style="text-align:left">A prototype library that allows spawning no-argument tasks and sync tasks</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">April 11-April 17</td>
<td style="text-align:left">A prototype with <code>spawn</code>, <code>sync</code> semantics similar in Cilk and able to set return value asynchronously + first benchmark test</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">April 18-April 24</td>
<td style="text-align:left">An implementation of work stealing protocol in a potentially non-scalable way + second benchmark test</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">April 25-May 1</td>
<td style="text-align:left">Scale work stealing based on second benchmark test</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">May 2-May 9</td>
<td style="text-align:left">Toward a self-implementated thread and lock</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2>Reference</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Blumofe, Robert D., et al. “Cilk: An efficient multithreaded runtime system.” Journal of parallel and distributed computing 37.1 (1996): 55-69. <a href="#fnref1" class="footnote-backref">↩</a></p>
</li>
<li id="fn2" class="footnote-item"><p>Blumofe, Robert D., and Charles E. Leiserson. “Scheduling multithreaded computations by work stealing.” Journal of the ACM (JACM) 46.5 (1999): 720-748. <a href="#fnref2" class="footnote-backref">↩</a></p>
</li>
<li id="fn3" class="footnote-item"><p>Frigo, Matteo, Charles E. Leiserson, and Keith H. Randall. “The implementation of the Cilk-5 multithreaded language.” ACM Sigplan Notices. Vol. 33. No. 5. ACM, 1998. <a href="#fnref3" class="footnote-backref">↩</a></p>
</li>
<li id="fn4" class="footnote-item"><p>Joerg, Christopher F. The cilk system for parallel multithreaded computing. Diss. Massachusetts Institute of Technology, 1996. <a href="#fnref4" class="footnote-backref">↩</a></p>
</li>
<li id="fn5" class="footnote-item"><p>Blumofe, Robert D. Executing multithreaded programs efficiently. Diss. Massachusetts Institute of Technology, 1995. <a href="#fnref5" class="footnote-backref">↩</a></p>
</li>
<li id="fn6" class="footnote-item"><p>Kielmann, T., R. Nieuwpoort, and H. Bal. “Cilk-5.3 Reference Manual.” Supercomputing Technologies Group (2000). <a href="#fnref6" class="footnote-backref">↩</a></p>
</li>
</ol>
</section>

    
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpeg"
               alt="MallocAnswer" />
          <p class="site-author-name" itemprop="name">MallocAnswer</p>
          <p class="site-description motion-element" itemprop="description">My Heart Is In The Work</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">1</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/mallocanswer" target="_blank">
                  
                    <i class="fa fa-github"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/lhsun" target="_blank">
                  
                    <i class="fa fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/lehao.sun" target="_blank">
                  
                    <i class="fa fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">MallocAnswer</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'mallocanswer';
      var disqus_identifier = 'proposal/index.html';
      var disqus_title = '';
      var disqus_url = 'http://mallocanswer.github.io/proposal/index.html';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  



  
  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
